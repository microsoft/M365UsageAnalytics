expression 'Errors in SecDemoM365Usage' =
		let
		Source = SecDemoM365Usage,
		  #"Detected Type Mismatches" = let
		    tableWithOnlyPrimitiveTypes = Table.SelectColumns(Source, Table.ColumnsOfType(Source, {type nullable number, type nullable text, type nullable logical, type nullable date, type nullable datetime, type nullable datetimezone, type nullable time, type nullable duration})),
		    recordTypeFields = Type.RecordFields(Type.TableRow(Value.Type(tableWithOnlyPrimitiveTypes))),
		    fieldNames = Record.FieldNames(recordTypeFields),
		    fieldTypes = List.Transform(Record.ToList(recordTypeFields), each [Type]),
		    pairs = List.Transform(List.Positions(fieldNames), (i) => {fieldNames{i}, (v) => if v = null or Value.Is(v, fieldTypes{i}) then v else error [Message = "The type of the value does not match the type of the column.", Detail = v], fieldTypes{i}})
		in
		    Table.TransformColumns(Source, pairs),
		  #"Added Index" = Table.AddIndexColumn(#"Detected Type Mismatches", "Row Number" ,1),
		  #"Kept Errors" = Table.SelectRowsWithErrors(#"Added Index", {"RecordId", "CreationDate", "RecordType", "Operation", "UserId", "AuditData", "AssociatedAdminUnits", "AssociatedAdminUnitsNames", "CreationTime", "Id", "OrganizationId", "ResultStatus", "UserKey", "UserType", "Version", "Workload", "ClientIP", "ObjectId", "AzureActiveDirectoryEventType", "ExtendedProperties", "ExtendedProperties.ResultStatusDetail", "ExtendedProperties.Name", "ExtendedProperties.Value", "ExtendedProperties.UserAgent", "ExtendedProperties.RequestType", "ModifiedProperties", "Actor", "Actor.ID", "Actor.Type", "ActorContextId", "ActorIpAddress", "InterSystemsId", "IntraSystemId", "SupportTicketId", "Target", "Target.ID", "Target.Type", "TargetContextId", "ApplicationId", "DeviceProperties", "DeviceProperties.OS", "DeviceProperties.Name", "DeviceProperties.Value", "DeviceProperties.BrowserType", "DeviceProperties.SessionId", "ErrorNumber", "ExtendedProperties.KeepMeSignedIn", "DeviceProperties.Id", "DeviceProperties.DisplayName", "DeviceProperties.TrustType", "ExtendedProperties.UserAuthenticationMethod", "DeviceProperties.IsCompliant", "DeviceProperties.IsCompliantAndManaged", "SiteUrl", "SourceRelativeUrl", "SourceFileName", "SourceFileExtension", "ListId", "ListItemUniqueId", "WebId", "ApplicationDisplayName", "EventSource", "ItemType", "SiteSensitivityLabelId", "GeoLocation", "IsManagedDevice", "DeviceDisplayName", "ListBaseType", "ListServerTemplate", "AuthenticationType", "Site", "DoNotDistributeEvent", "HighPriorityMediaProcessing", "AppAccessContext.ClientAppId", "AppAccessContext.ClientAppName", "AppAccessContext.CorrelationId", "AppAccessContext.AADSessionId", "AppAccessContext.UniqueTokenId", "AppAccessContext.AuthTime", "AppAccessContext.TokenIssuedAtTime", "AppAccessContext.UserObjectId", "AppAccessContext.DeviceId", "AppAccessContext.@odata.type", "AppAccessContext.APIId", "AppAccessContext.IssuedAtTime", "@odata.type", "RecordType@odata.type", "UserType@odata.type", "Version@odata.type", "BrowserName", "BrowserVersion", "CorrelationId", "Platform", "UserAgent", "ListBaseType@odata.type", "ListServerTemplate@odata.type", "ActorInfoString", "AppId", "AuthType", "ClientAppId", "ClientIPAddress", "ClientInfoString", "ExternalAccess", "InternalLogonType@odata.type", "InternalLogonType", "LogonType@odata.type", "LogonType", "LogonUserSid", "MailboxGuid", "MailboxOwnerSid", "MailboxOwnerUPN", "OrganizationName", "OriginatingServer", "SessionId", "TokenObjectId", "TokenTenantId", "TokenType", "SaveToSentItems", "Item.@odata.type", "Item.Id", "Item.ImmutableId", "Item.InternetMessageId", "Item.SizeInBytes@odata.type", "Item.SizeInBytes", "Item.Subject", "Item.ParentFolder.@odata.type", "Item.ParentFolder.Id", "Item.ParentFolder.Path", "OperationCount@odata.type", "OperationCount", "OperationProperties.Name", "OperationProperties.Value", "Folders.Id", "Folders.Path", "Folders.FolderItems.ClientRequestId", "Folders.FolderItems.Id", "Folders.FolderItems.ImmutableId", "Folders.FolderItems.InternetMessageId", "Folders.FolderItems.SizeInBytes@odata.type", "Folders.FolderItems.SizeInBytes", "FileSizeBytes@odata.type", "FileSizeBytes", "AzureActiveDirectoryEventType@odata.type", "Actor.Type@odata.type", "Target.Type@odata.type", "MeetingId", "MeetingType", "EventSignature", "EventData", "Permission", "SensitivityLabelId", "SharingLinkScope", "TargetUserOrGroupType", "TargetUserOrGroupName", "MeetingURL", "ChatId", "MessageId", "MessageSizeInBytes@odata.type", "MessageSizeInBytes", "MessageType", "FormId", "FormName", "VideoId", "VideoName", "ChannelId", "ViewDuration@odata.type", "ViewDuration", "ClientRegion", "CopilotLogVersion", "TargetId", "ModifiedProperties.Name", "ModifiedProperties.NewValue", "ModifiedProperties.OldValue", "TeamName", "TeamGuid", "Members.ObjectId", "Members.UPN", "Members.DisplayName", "ResponseId", "IsAnonymous", "DeviceType", "ChannelName", "ChannelGuid", "ChannelType", "Members.Role", "AppName", "EnvironmentName", "PlanId", "PlanName", "TaskId", "TaskName", "PercentComplete@odata.type", "PercentComplete", "CrossMailboxOperation", "AffectedItems.Id", "AffectedItems.InternetMessageId", "AffectedItems.Subject", "AffectedItems.ParentFolder.@odata.type", "AffectedItems.ParentFolder.Id", "AffectedItems.ParentFolder.Path", "Folder.@odata.type", "Folder.Id", "Folder.Path", "DestFolder.@odata.type", "DestFolder.Id", "DestFolder.Path", "RecordTypeNum", "ResultStatus_Audit", "ModelId", "ModelProvider", "ModelFamily", "TokensTotal", "TokensInput", "TokensOutput", "DurationMs", "OutcomeStatus", "ConversationId", "TurnNumber", "RetryCount", "ClientVersion", "ClientPlatform", "AgentId", "AgentName", "AgentVersion", "AgentCategory", "AppIdentity", "AppIdentity_DisplayName", "AppIdentity_PublisherId", "ApplicationName", "AppHost", "ThreadId", "Context_Id", "Context_Type", "Message_Id", "Message_isPrompt", "AccessedResource_Action", "AccessedResource_PolicyDetails", "AccessedResource_SiteUrl", "AISystemPlugin_Id", "AISystemPlugin_Name", "ModelTransparencyDetails_ModelName", "MessageIds", "AccessedResource_Name", "AccessedResource_SensitivityLabel", "AccessedResource_ResourceType", "SensitivityLabel", "Context_Item"}),
		  #"Reordered Columns" = Table.ReorderColumns(#"Kept Errors", {"Row Number", "RecordId", "CreationDate", "RecordType", "Operation", "UserId", "AuditData", "AssociatedAdminUnits", "AssociatedAdminUnitsNames", "CreationTime", "Id", "OrganizationId", "ResultStatus", "UserKey", "UserType", "Version", "Workload", "ClientIP", "ObjectId", "AzureActiveDirectoryEventType", "ExtendedProperties", "ExtendedProperties.ResultStatusDetail", "ExtendedProperties.Name", "ExtendedProperties.Value", "ExtendedProperties.UserAgent", "ExtendedProperties.RequestType", "ModifiedProperties", "Actor", "Actor.ID", "Actor.Type", "ActorContextId", "ActorIpAddress", "InterSystemsId", "IntraSystemId", "SupportTicketId", "Target", "Target.ID", "Target.Type", "TargetContextId", "ApplicationId", "DeviceProperties", "DeviceProperties.OS", "DeviceProperties.Name", "DeviceProperties.Value", "DeviceProperties.BrowserType", "DeviceProperties.SessionId", "ErrorNumber", "ExtendedProperties.KeepMeSignedIn", "DeviceProperties.Id", "DeviceProperties.DisplayName", "DeviceProperties.TrustType", "ExtendedProperties.UserAuthenticationMethod", "DeviceProperties.IsCompliant", "DeviceProperties.IsCompliantAndManaged", "SiteUrl", "SourceRelativeUrl", "SourceFileName", "SourceFileExtension", "ListId", "ListItemUniqueId", "WebId", "ApplicationDisplayName", "EventSource", "ItemType", "SiteSensitivityLabelId", "GeoLocation", "IsManagedDevice", "DeviceDisplayName", "ListBaseType", "ListServerTemplate", "AuthenticationType", "Site", "DoNotDistributeEvent", "HighPriorityMediaProcessing", "AppAccessContext.ClientAppId", "AppAccessContext.ClientAppName", "AppAccessContext.CorrelationId", "AppAccessContext.AADSessionId", "AppAccessContext.UniqueTokenId", "AppAccessContext.AuthTime", "AppAccessContext.TokenIssuedAtTime", "AppAccessContext.UserObjectId", "AppAccessContext.DeviceId", "AppAccessContext.@odata.type", "AppAccessContext.APIId", "AppAccessContext.IssuedAtTime", "@odata.type", "RecordType@odata.type", "UserType@odata.type", "Version@odata.type", "BrowserName", "BrowserVersion", "CorrelationId", "Platform", "UserAgent", "ListBaseType@odata.type", "ListServerTemplate@odata.type", "ActorInfoString", "AppId", "AuthType", "ClientAppId", "ClientIPAddress", "ClientInfoString", "ExternalAccess", "InternalLogonType@odata.type", "InternalLogonType", "LogonType@odata.type", "LogonType", "LogonUserSid", "MailboxGuid", "MailboxOwnerSid", "MailboxOwnerUPN", "OrganizationName", "OriginatingServer", "SessionId", "TokenObjectId", "TokenTenantId", "TokenType", "SaveToSentItems", "Item.@odata.type", "Item.Id", "Item.ImmutableId", "Item.InternetMessageId", "Item.SizeInBytes@odata.type", "Item.SizeInBytes", "Item.Subject", "Item.ParentFolder.@odata.type", "Item.ParentFolder.Id", "Item.ParentFolder.Path", "OperationCount@odata.type", "OperationCount", "OperationProperties.Name", "OperationProperties.Value", "Folders.Id", "Folders.Path", "Folders.FolderItems.ClientRequestId", "Folders.FolderItems.Id", "Folders.FolderItems.ImmutableId", "Folders.FolderItems.InternetMessageId", "Folders.FolderItems.SizeInBytes@odata.type", "Folders.FolderItems.SizeInBytes", "FileSizeBytes@odata.type", "FileSizeBytes", "AzureActiveDirectoryEventType@odata.type", "Actor.Type@odata.type", "Target.Type@odata.type", "MeetingId", "MeetingType", "EventSignature", "EventData", "Permission", "SensitivityLabelId", "SharingLinkScope", "TargetUserOrGroupType", "TargetUserOrGroupName", "MeetingURL", "ChatId", "MessageId", "MessageSizeInBytes@odata.type", "MessageSizeInBytes", "MessageType", "FormId", "FormName", "VideoId", "VideoName", "ChannelId", "ViewDuration@odata.type", "ViewDuration", "ClientRegion", "CopilotLogVersion", "TargetId", "ModifiedProperties.Name", "ModifiedProperties.NewValue", "ModifiedProperties.OldValue", "TeamName", "TeamGuid", "Members.ObjectId", "Members.UPN", "Members.DisplayName", "ResponseId", "IsAnonymous", "DeviceType", "ChannelName", "ChannelGuid", "ChannelType", "Members.Role", "AppName", "EnvironmentName", "PlanId", "PlanName", "TaskId", "TaskName", "PercentComplete@odata.type", "PercentComplete", "CrossMailboxOperation", "AffectedItems.Id", "AffectedItems.InternetMessageId", "AffectedItems.Subject", "AffectedItems.ParentFolder.@odata.type", "AffectedItems.ParentFolder.Id", "AffectedItems.ParentFolder.Path", "Folder.@odata.type", "Folder.Id", "Folder.Path", "DestFolder.@odata.type", "DestFolder.Id", "DestFolder.Path", "RecordTypeNum", "ResultStatus_Audit", "ModelId", "ModelProvider", "ModelFamily", "TokensTotal", "TokensInput", "TokensOutput", "DurationMs", "OutcomeStatus", "ConversationId", "TurnNumber", "RetryCount", "ClientVersion", "ClientPlatform", "AgentId", "AgentName", "AgentVersion", "AgentCategory", "AppIdentity", "AppIdentity_DisplayName", "AppIdentity_PublisherId", "ApplicationName", "AppHost", "ThreadId", "Context_Id", "Context_Type", "Message_Id", "Message_isPrompt", "AccessedResource_Action", "AccessedResource_PolicyDetails", "AccessedResource_SiteUrl", "AISystemPlugin_Id", "AISystemPlugin_Name", "ModelTransparencyDetails_ModelName", "MessageIds", "AccessedResource_Name", "AccessedResource_SensitivityLabel", "AccessedResource_ResourceType", "SensitivityLabel", "Context_Item"})
		in
		  #"Reordered Columns"
	lineageTag: 33a66703-0018-4411-986c-17aafbb17cb1
	queryGroup: 'Query Errors - 1/26/2026 2:32:17 PM'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

